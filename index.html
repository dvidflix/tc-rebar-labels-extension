<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rebar Labels Demo</title>
  <script src="https://unpkg.com/trimble-connect-workspace-api@latest"></script>
  <style>
    body { font-family: Arial; padding: 20px; }
    button { padding: 10px; margin: 10px 0; }
  </style>
</head>
<body>
  <h1>Rebar Labels Extension</h1>
  <p>Status: <span id="status">Connecting...</span></p>
  <button id="testButton" disabled>Test Viewer Connection</button>

  <script>
    let tcApi;

    async function init() {
      try {
        tcApi = await connect(window.parent);  // Connects to Trimble Connect
        document.getElementById('status').textContent = 'Connected!';
        
        // Set menu (optional but nice)
        await tcApi.ui.setMenu({
          title: 'Rebar Labels',
          command: 'refresh'
        });

        document.getElementById('testButton').disabled = false;
      } catch (err) {
        document.getElementById('status').textContent = 'Error: ' + err;
      }
    }

    document.getElementById('testButton').onclick = async () => {
      if (!tcApi) return;
      try {
        const models = await tcApi.model.getModels();
        alert(`Found ${models.length} model(s) loaded!`);
      } catch (err) {
        alert('Error: ' + err);
      }
    };

    init();
  </script>
</body>
</html>